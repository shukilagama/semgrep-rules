rules:
- id: metadata-category
  message: >-
    This Semgrep rule is missing a valid 'category' field in the 'metadata'. 'category' must be one of
    'security', 'correctness', 'best-practice', 'performance', 'maintainability', or 'portability'.
  severity: INFO
  metadata:
    category: best-practice
    technology:
    - semgrep
  languages: [yaml]
  patterns:
  - pattern-inside: 'rules: [..., $RULE, ...]'
  - pattern: 'id: $RULEID'
  - pattern-not-inside: |
      - ...
        metadata:
          ...
          category: $CATEGORY

